G.Graphic.MovablePoint=G.Graphic.Point.extend({init:function(a,e,d){G.Graphic.Point.prototype.init.call(this,a,e,d);this.options.duration=this.options.duration||2E3},start:function(){this._i||(this._i=1);this._move();return this},stop:function(){this._tid&&clearTimeout(this._tid);return this},setRoute:function(a){this._setChunk(a);return this},_setChunk:function(a){var e=this.options.duration,d=a.length,g=0,m=[],l=this._pts=[],c,h,f,n,p,b,k;for(b=0;b<d-1;b++)c=a[b],f=a[b+1],c=G.MathUtil.calcDistance(c,
f),m.push(c),g+=c;for(b=0;b<d-1;b++)for(f=e*(m[b]/g)/30,c=a[b],h=a[b+1],n=(h[0]-c[0])/f,p=(h[1]-c[1])/f,k=0;k<f;k++)h=[c[0]+n*k,c[1]+p*k],l.push(h);l.push([a[d-1][0],a[d-1][1]]);return l},_move:function(){var a=this,e=a._pts,d=e.length,g=a._layer._map;a._updateGeom(e[a._i]);g._requestRedraw();a._i++;a._tid=setTimeout(function(){a._i===d?a.stop():a._move()},30)}});
